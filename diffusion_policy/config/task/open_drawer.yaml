name: open_drawer

#
observation_type: low_dim
num_objects: 5
num_keypoints: ${eval:'${task.num_objects} * 7'}

low_dim_shape_meta:
  obs:
    agent_pose:
      shape: [4,4]
      type: low_dim
    keypoint_pcd:
      shape: 
        - ${task.num_keypoints}
        - 3
      type: low_dim
    keypoint_idx:
      shape:
        - ${task.num_keypoints}
      type: low_dim
  action:
    shape: [4,4]

rgb_shape_meta:
  obs:
    image:
      shape: [3, 128, 128]
      type: rgb
    agent_pose:
      shape: [4,4]
      type: low_dim
  action:
    shape: [4,4]

# shape_meta: &shape_meta ${eval:'${task.low_dim_shape_meta} if True else ${task.rgb_shape_meta}'}
shape_meta: &shape_meta ${task.low_dim_shape_meta}
  # acceptable types: rgb, low_dim
  # obs:
  #   agent_pose:
  #     shape: [4,4]
  #     type: low_dim
  #   keypoint_pcd:
  #     shape: 
  #       - ${task.num_keypoints}
  #       - 3
  #     type: low_dim
  #   keypoint_idx:
  #     shape:
  #       - ${task.num_keypoints}
  #     type: low_dim
  # action:
  #   shape: [4,4]

gripper_loc_bounds: 
  _target_: diffusion_policy.common.common_utils.get_gripper_loc_bounds
  path: "/home/felix/Workspace/diffusion_policy_felix/diffusion_policy/tasks/18_peract_tasks_location_bounds.json"
  buffer: 0.0
  task: ${name}

dataset:
  _target_: diffusion_policy.dataset.rlbench_dataset.RLBenchDataset
  root: /home/felix/Workspace/diffusion_policy_felix/data/peract
  task_name: open_drawer
  cameras: []
  num_episodes: ${num_episodes}
  variation: 0
  demo_augmentation_every_n: 1
  n_obs: ${n_obs_steps}
  build_history_from_augment_obs: True
  keypoints_only: True
  val_ratio: 0.2

env_runner:
  _target_: diffusion_policy.env_runner.rlbench_lowdim_runner.RLBenchLowdimRunner
  data_root: ${task.dataset.root}
  task_str: "open_drawer"
  max_episodes: 1
  max_steps: ${eval:'10 if "${task.dataset.keypoints_only}" else 200'}
  max_rtt_tries: 10
  demo_tries: 1
  obs_history_augmentation_every_n: 1
  collision_checking: True
  action_dim: 8
  headless: True
